@using Netrunner.Shared.Chat
@inject HttpClient Http
<h3>Rooms</h3>

@if (_rooms == null)
{
    <Loading/>
}
else
{
    <ul>
        @foreach (var room in _rooms)
        {
            <li>
                <a href="@($"chat/{room.Id}")">@room.Name</a>
            </li>
        }
    </ul>
}

@code {
#nullable enable
    private IEnumerable<ChatRoom>? _rooms;

    protected override async Task OnInitializedAsync()
    {
        await Refresh();
    }

    public async Task Refresh()
    {
        Console.WriteLine("Refresh Chat Rooms");
        _rooms = await Http.GetFromJsonAsync<IEnumerable<ChatRoom>>($"api/v1/room");
    }

}